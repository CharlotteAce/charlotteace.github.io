!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("tmual",[],e):"object"==typeof exports?exports.tmual=e():t.tmual=e()}("undefined"!=typeof self?self:this,(function(){return function(){var t={751:function(t){"undefined"!=typeof self&&self,t.exports=function(){"use strict";var t={825:function(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Browser=e.Util=e.CLog=void 0;var o=r(n(148));e.CLog=o.default;var i=r(n(109));e.Util=i.default;var u=r(n(387));e.Browser=u.default},387:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(109));e.default={generateMetrics:function(t,e){if("object"!==r(t))return null;var n={},o=t.line||t.lineNumber,u=t.column||t.columnNumber;n.ts=i.default.getTime(),t.name&&(n.name=t.name),t.message&&(n.message=t.message),t.stack&&(n.stack=t.stack),o&&(n.line=o),u&&(n.col=u);var l="undefined"!=typeof window?window:{};return"object"===r(l.performance)&&"object"===r(l.performance.timing)&&i.default.isNumber(l.performance.timing.navigationStart)&&(n.progress_time=n.ts-l.performance.timing.navigationStart),n.ex_base="",void 0!==l.location&&void 0!==l.location.href&&(n.url=l.location.href),i.default.isString(e)&&(n.label=e),n},createImageTag:function(t,e){if("undefined"!=typeof document){var n=document.createElement("img");i.default.isFunction(e)&&(n.onload=e),n.src=t}}}},148:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(109));function u(){return["Object","Console","console"].indexOf(i.default.getType(console))>=0?console:{}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"NONE",get:function(){return 0}},{key:"CRITICAL",get:function(){return 1}},{key:"WARNING",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"prefix",set:function(t){this._prefix=t}},{key:"defaultLogLevel",get:function(){return this.CRITICAL}},{key:"logLevel",get:function(){return i.default.isNumber(this._logLevel)?this._logLevel:this.defaultLogLevel},set:function(t){i.default.isNumber(t)&&[0,1,2,3,4].indexOf(t)>=0&&(this._logLevel=t)}},{key:"debug",value:function(){var e=u();if(this.logLevel>=t.DEBUG){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];i.default.isFunction(e.debug)?this.printLog(e.debug,r):i.default.isFunction(e.log)&&(r.unshift("[DEBUG]"),this.printLog(e.log,r))}}},{key:"info",value:function(){var e=u();if(this.logLevel>=t.INFO){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];i.default.isFunction(e.info)?this.printLog(e.info,r):i.default.isFunction(e.log)&&(r.unshift("[INFO]"),this.printLog(e.log,r))}}},{key:"warning",value:function(){var e=u();if(this.logLevel>=t.WARNING){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];i.default.isFunction(e.warn)?this.printLog(e.warn,r):i.default.isFunction(e.log)&&(r.unshift("[WARN]"),this.printLog(e.log,r))}}},{key:"error",value:function(){var e=u();if(this.logLevel>=t.CRITICAL){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];i.default.isFunction(e.error)?this.printLog(e.error,r):i.default.isFunction(e.log)&&(r.unshift("[ERROR]"),this.printLog(e.log,r))}}},{key:"printLog",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],o=e[1],u=new Date;o.unshift("[".concat(u.toLocaleTimeString(),".").concat(u.getUTCMilliseconds(),"]")),i.default.isEmpty(this._prefix)||o.unshift(this._prefix),r.apply(console,o)}}],n&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=l},109:function(t,e){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t){return Object.prototype.toString.call(t).slice(8,-1)}function o(t,e){return null!=e&&r(e)===t}function i(t){return o("Object",t)}function u(t){return o("Array",t)}function l(t){return o("String",t)}function a(t){return Math.abs(t)===1/0}function c(t){return o("Number",t)&&!d(t)&&!a(t)}function f(t){return o("Boolean",t)}function s(t){return o("Map",t)}function y(t){return null===t}function p(t){return void 0===t}function d(t){return!("object"!==n(t)||!o("Number",t)||!isNaN(t))||o("Number",t)&&t!=t}function v(t){return""+t}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return c(t=Number(t))?t:e}function b(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(t=m(t,e))===e?t:parseInt(t)}function g(t){var e=t.split("#")[0].split("?");return 1===e.length?null:e.slice(1).join("?")}Object.defineProperty(e,"__esModule",{value:!0}),e.default={getType:r,is:o,isObject:i,isArray:u,isString:l,isNumber:c,isBoolean:f,isMap:s,isPrimitive:function(t){return c(t)||l(t)||f(t)},isFunction:function(t){return o("Function",t)},isNull:y,isNaN:d,isUndefined:p,findKey:function(t,e){return o("Object",t)&&Object.prototype.hasOwnProperty.call(t,e)},isUUID:function(t){return null!==t.match(/^[\da-fA-F]{8}-[\da-fA-F]{4}-[\da-fA-F]{4}-[\da-fA-F]{4}-[\da-fA-F]{12}$/)},deepCopy:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments,e=arguments.length,n={},r=function(e){var r=e<0||t.length<=e?void 0:t[e];Object.keys(r).forEach((function(t){n[t]=r[t]}))},o=0;o<e;o++)r(o);return n},getTime:function(){return(new Date).getTime()},normalizeToString:v,normalizeToNumber:m,normalizeToInt:b,normalizeToUnsignedInt:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(t=b(t,e))===e||t>=0?t:e},isEmpty:function(t){return!!(y(t)||p(t)||d(t))||(l(t)?""===t:c(t)||a(t)?0===t:i(t)?0===Object.keys(t).length:u(t)?0===t.length:!!s(t)&&0===t.size)},snakeToLCC:function(t){return(t=v(t).replace(/_+([a-z])/g,(function(t,e){return e.toUpperCase()}))).charAt(0).toLowerCase()+t.slice(1)},urlQueryBuild:function(t){return Object.keys(t).map((function(e){return[e,t[e]].map(v).map(encodeURIComponent).join("=")})).join("&")},urlQueryString:g,urlQueryParse:function(t){return g("?".concat(t)).split("&").reduce((function(t,e){var n=e.split("=");return 2===n.length&&(t[n[0]]=n[1]),t}),{})}}}},e={};return function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}(825)}()},295:function(t){var e,n;"undefined"!=typeof self&&self,t.exports=(e={514:function(t,e,n){"undefined"!=typeof self&&self,t.exports=function(){"use strict";var t={d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};t.d(e,{default:function(){return a}});var r,o=n(751),i=function(){function t(t){this.settings=t}return t.prototype.setAccessToken=function(t){this.settings.accessToken=t},t.prototype.setHost=function(t){this.settings.host=t},t.prototype.dispatch=function(t){var e=this.settings,n={tk:e.userId,p:e.project,d:e.dataset};e.accessToken&&(n.access_token=e.accessToken);var r=o.Util.merge(n,t),i=this.buildUrl(e.host,r);o.Browser.createImageTag(i,null)},t.prototype.buildUrl=function(t,e){var n="https://".concat(t,"/api/v1/clear.gif"),r=o.Util.urlQueryBuild(e);return"".concat(n,"?").concat(r)},t}(),u=function(){function t(){}return t.getDefaultHost=function(t){var e="dsb.yahoo.co.jp",n=void 0!==t?t.document:{},r=o.Util.getType(n);return/^(HTML)?Document$/.test(r)?new RegExp("".concat("yahoo.co.jp","$")).test(n.location.hostname)?e:"dsb.yahooapis.jp":e},t}().getDefaultHost(window);!function(t){t.DEBUG="debug",t.EXCEPTION="exception"}(r||(r={}));var l=function(){function t(t){var e,n,r,o,i;this.pageSession=null!==(e=null==t?void 0:t.pageSession)&&void 0!==e?e:"",this.sdkName=null!==(n=null==t?void 0:t.coreName)&&void 0!==n?n:"",this.sdkVersion=null!==(r=null==t?void 0:t.coreVersion)&&void 0!==r?r:"",this.extensionName=null!==(o=null==t?void 0:t.targetName)&&void 0!==o?o:"",this.extensionVersion=null!==(i=null==t?void 0:t.targetVersion)&&void 0!==i?i:""}return t.prototype.setExtensionName=function(t){this.extensionName=t},t.prototype.setExtensionVersion=function(t){this.extensionVersion=t},t.prototype.build=function(t){var e,n,r,o,i,u,l,a,c,f,s;return{log_type:null!==(e=null==t?void 0:t.type)&&void 0!==e?e:"",label:null!==(n=null==t?void 0:t.label)&&void 0!==n?n:"",ts:this.time(),name:null!==(o=null===(r=null==t?void 0:t.error)||void 0===r?void 0:r.name)&&void 0!==o?o:"",message:null!==(u=null===(i=null==t?void 0:t.error)||void 0===i?void 0:i.message)&&void 0!==u?u:"",stack:null!==(a=null===(l=null==t?void 0:t.error)||void 0===l?void 0:l.stack)&&void 0!==a?a:"",elapsed_time:this.elapsedTime(),url:this.url(),referrer:this.referrer(),page_session:this.pageSession,sdk:this.sdkName,sdk_ver:this.sdkVersion,extension:this.extensionName,extension_ver:this.extensionVersion,custom_1:null!==(c=null==t?void 0:t.custom1)&&void 0!==c?c:"",custom_2:null!==(f=null==t?void 0:t.custom2)&&void 0!==f?f:"",custom_3:null!==(s=null==t?void 0:t.custom3)&&void 0!==s?s:""}},t.prototype.time=function(){return o.Util.getTime()},t.prototype.elapsedTime=function(){return"undefined"==typeof performance?0:Math.floor(performance.now())},t.prototype.url=function(){return"undefined"==typeof document?"":document.URL},t.prototype.referrer=function(){return"undefined"==typeof document?"":document.referrer},t}(),a=function(){function t(t){void 0===t&&(t={});var e=t.host,n=void 0===e?u:e,r=t.accessToken,o=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}(t,["host","accessToken"]);this.dispatcher=new i({userId:"9225bd01-1ff0-4e57-9c92-6e831c45253a",project:"ds_logger",dataset:"ual_web_error",host:n,accessToken:r}),this.builder=new l(o)}return t.prototype.setAccessToken=function(t){this.dispatcher.setAccessToken(t)},t.prototype.setHost=function(t){this.dispatcher.setHost(t)},t.prototype.setTargetName=function(t){this.builder.setExtensionName(t)},t.prototype.setTargetVersion=function(t){this.builder.setExtensionVersion(t)},t.prototype.debug=function(t){this.log(r.DEBUG,t)},t.prototype.exception=function(t,e){this.log(r.EXCEPTION,e,t)},t.prototype.log=function(t,e,n){var r={};r.type=t,r.label=null==e?void 0:e.label,r.custom1=null==e?void 0:e.custom1,r.custom2=null==e?void 0:e.custom2,r.custom3=null==e?void 0:e.custom3,r.error=n;var o=this.builder.build(r);this.dispatcher.dispatch(o)},t}();return e.default}()},751:function(t){"undefined"!=typeof self&&self,t.exports=function(){"use strict";var t={825:function(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Browser=e.Util=e.CLog=void 0;var o=r(n(148));e.CLog=o.default;var i=r(n(109));e.Util=i.default;var u=r(n(387));e.Browser=u.default},387:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(109));e.default={generateMetrics:function(t,e){if("object"!==r(t))return null;var n={},o=t.line||t.lineNumber,u=t.column||t.columnNumber;n.ts=i.default.getTime(),t.name&&(n.name=t.name),t.message&&(n.message=t.message),t.stack&&(n.stack=t.stack),o&&(n.line=o),u&&(n.col=u);var l="undefined"!=typeof window?window:{};return"object"===r(l.performance)&&"object"===r(l.performance.timing)&&i.default.isNumber(l.performance.timing.navigationStart)&&(n.progress_time=n.ts-l.performance.timing.navigationStart),n.ex_base="",void 0!==l.location&&void 0!==l.location.href&&(n.url=l.location.href),i.default.isString(e)&&(n.label=e),n},createImageTag:function(t,e){if("undefined"!=typeof document){var n=document.createElement("img");i.default.isFunction(e)&&(n.onload=e),n.src=t}}}},148:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(109));function u(){return["Object","Console","console"].indexOf(i.default.getType(console))>=0?console:{}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"NONE",get:function(){return 0}},{key:"CRITICAL",get:function(){return 1}},{key:"WARNING",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"prefix",set:function(t){this._prefix=t}},{key:"defaultLogLevel",get:function(){return this.CRITICAL}},{key:"logLevel",get:function(){return i.default.isNumber(this._logLevel)?this._logLevel:this.defaultLogLevel},set:function(t){i.default.isNumber(t)&&[0,1,2,3,4].indexOf(t)>=0&&(this._logLevel=t)}},{key:"debug",value:function(){var e=u();if(this.logLevel>=t.DEBUG){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];i.default.isFunction(e.debug)?this.printLog(e.debug,r):i.default.isFunction(e.log)&&(r.unshift("[DEBUG]"),this.printLog(e.log,r))}}},{key:"info",value:function(){var e=u();if(this.logLevel>=t.INFO){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];i.default.isFunction(e.info)?this.printLog(e.info,r):i.default.isFunction(e.log)&&(r.unshift("[INFO]"),this.printLog(e.log,r))}}},{key:"warning",value:function(){var e=u();if(this.logLevel>=t.WARNING){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];i.default.isFunction(e.warn)?this.printLog(e.warn,r):i.default.isFunction(e.log)&&(r.unshift("[WARN]"),this.printLog(e.log,r))}}},{key:"error",value:function(){var e=u();if(this.logLevel>=t.CRITICAL){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];i.default.isFunction(e.error)?this.printLog(e.error,r):i.default.isFunction(e.log)&&(r.unshift("[ERROR]"),this.printLog(e.log,r))}}},{key:"printLog",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],o=e[1],u=new Date;o.unshift("[".concat(u.toLocaleTimeString(),".").concat(u.getUTCMilliseconds(),"]")),i.default.isEmpty(this._prefix)||o.unshift(this._prefix),r.apply(console,o)}}],n&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=l},109:function(t,e){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t){return Object.prototype.toString.call(t).slice(8,-1)}function o(t,e){return null!=e&&r(e)===t}function i(t){return o("Object",t)}function u(t){return o("Array",t)}function l(t){return o("String",t)}function a(t){return Math.abs(t)===1/0}function c(t){return o("Number",t)&&!d(t)&&!a(t)}function f(t){return o("Boolean",t)}function s(t){return o("Map",t)}function y(t){return null===t}function p(t){return void 0===t}function d(t){return!("object"!==n(t)||!o("Number",t)||!isNaN(t))||o("Number",t)&&t!=t}function v(t){return""+t}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return c(t=Number(t))?t:e}function b(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(t=m(t,e))===e?t:parseInt(t)}function g(t){var e=t.split("#")[0].split("?");return 1===e.length?null:e.slice(1).join("?")}Object.defineProperty(e,"__esModule",{value:!0}),e.default={getType:r,is:o,isObject:i,isArray:u,isString:l,isNumber:c,isBoolean:f,isMap:s,isPrimitive:function(t){return c(t)||l(t)||f(t)},isFunction:function(t){return o("Function",t)},isNull:y,isNaN:d,isUndefined:p,findKey:function(t,e){return o("Object",t)&&Object.prototype.hasOwnProperty.call(t,e)},isUUID:function(t){return null!==t.match(/^[\da-fA-F]{8}-[\da-fA-F]{4}-[\da-fA-F]{4}-[\da-fA-F]{4}-[\da-fA-F]{12}$/)},deepCopy:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments,e=arguments.length,n={},r=function(e){var r=e<0||t.length<=e?void 0:t[e];Object.keys(r).forEach((function(t){n[t]=r[t]}))},o=0;o<e;o++)r(o);return n},getTime:function(){return(new Date).getTime()},normalizeToString:v,normalizeToNumber:m,normalizeToInt:b,normalizeToUnsignedInt:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(t=b(t,e))===e||t>=0?t:e},isEmpty:function(t){return!!(y(t)||p(t)||d(t))||(l(t)?""===t:c(t)||a(t)?0===t:i(t)?0===Object.keys(t).length:u(t)?0===t.length:!!s(t)&&0===t.size)},snakeToLCC:function(t){return(t=v(t).replace(/_+([a-z])/g,(function(t,e){return e.toUpperCase()}))).charAt(0).toLowerCase()+t.slice(1)},urlQueryBuild:function(t){return Object.keys(t).map((function(e){return[e,t[e]].map(v).map(encodeURIComponent).join("=")})).join("&")},urlQueryString:g,urlQueryParse:function(t){return g("?".concat(t)).split("&").reduce((function(t,e){var n=e.split("=");return 2===n.length&&(t[n[0]]=n[1]),t}),{})}}}},e={};return function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}(825)}()},778:function(t,e,n){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0});var o=n(751),i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"recordBuild",value:function(t,e,n,r){if(!o.Util.isString(t)||!o.Util.isUUID(t))return o.CLog.error("tokenが不正な値:",t),null;if(!o.Util.isString(e)||e.length<1)return o.CLog.error("projectが不正な値:",e),null;if(!o.Util.isString(n)||n.length<1)return o.CLog.error("datasetが不正な値:",n),null;if(!o.Util.isObject(r))return o.CLog.error("dataが不正な値:",r),null;var i=o.Util.deepCopy(r);Object.keys(i).forEach((function(t){0===t.indexOf("cex_")&&(o.CLog.warning("パラメータ ".concat(t,": cex_で始まるキーは予約済みキーのため使用できません.")),delete i[t])})),i.cex_cqt=o.Util.getTime();var u={tk:t,p:e,d:n,data:i};return o.CLog.info("[レコード生成]",u),u}},{key:"recordsBuild",value:function(t,e,n,r){var i=this,u=[],l=function(r){var l=i.recordBuild(t,e,n,r);o.Util.isNull(l)||u.push(l)};return o.Util.isObject(r)?l(r):o.Util.isArray(r)&&r.forEach(l),u}},{key:"requestBodyBuild",value:function(t){var e={},n=o.Util.deepCopy(t);return e.cex_cst=o.Util.getTime(),JSON.stringify({r:n,bp:e})}}],n&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=i},888:function(t,e,n){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(751),u=o(n(284)),l=o(n(778)),a=o(n(13)),c=n(646),f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset(),this.online=!0}var e,n;return e=t,n=[{key:"push",value:function(t,e,n,r){var o=l.default.recordsBuild(t,e,n,r),u=o.map((function(t){return JSON.stringify(t).length})),c=u.reduce((function(t,e){return t+e}),0),f=o.length,s=Math.max(0,a.default.get("maxRequestCharCount")),y=Math.max(0,a.default.get("maxRequestMessageCount"));if(!(f<1))if(c>s)i.CLog.error("データのサイズが大きすぎます。データを破棄します  ".concat(c,"/").concat(s),o);else if(f>y&&i.CLog.warning("規定値を超えた件数のログが送信されます ".concat(f,"/").concat(y),o),this.charCount+c<=s&&this.queue.length+f<=y)this.queue=this.queue.concat(o),this.charCount+=c,this.charCountArray=this.charCountArray.concat(u);else if(this.online)this.send(),this.queue=this.queue.concat(o),this.charCount+=c,this.charCountArray=this.charCountArray.concat(u);else for(this.queue=this.queue.concat(o),this.charCount+=c,this.charCountArray=this.charCountArray.concat(u);this.charCount>s||this.queue.length>y;)i.CLog.warning("データ容量超過のため削除",this.queue[0]),this.queue.shift(),this.charCount-=this.charCountArray[0],this.charCountArray.shift()}},{key:"send",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if((0,c.sendDebug)("Buffer.send#start"),this.queue.length>0&&this.online){var e=l.default.requestBodyBuild(this.queue);u.default.send(e,t),this.reset()}(0,c.sendDebug)("Buffer.send#end")}},{key:"reset",value:function(){this.queue=[],this.charCount=0,this.charCountArray=[]}}],n&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=f},13:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(751),i=r(n(909)),u=r(n(624)),l=r(n(808)),a={},c={get:function(t){return void 0!==a[t]?a[t]:null},set:function(t,e){a[t]=e,"apiHost"===t&&"https://"===a.apiScheme&&(0,i.default)("".concat(a.apiScheme).concat(a.apiHost))}};c.set("apiScheme","https://"),c.set("apiHost",u.default.getDefaultHost()),c.set("apiPath","/api/v1/stream"),c.set("sendBeaconEnabled",!0),c.set("targetProtocols",["http:","https:"]),c.set("ajaxTimeout",5e3),c.set("maxRequestCharCount",65497),c.set("maxRequestMessageCount",50),c.set("shortTimerInterval",1e3),c.set("longTimerInterval",5e3),c.set("errorLoggingEnabled",!1),c.set("sdkName",l.default.name),c.set("sdkVersion",l.default.version),o.CLog.debug("[config]",c),e.default=c},309:function(t,e,n){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(751),u=o(n(888)),l=o(n(305)),a=o(n(13)),c=n(646),f=o(n(539));(0,c.sendDebug)("core#start");var s=new u.default,y=new l.default(s);i.CLog.prefix="[CoreLogger]";var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"setConsoleLogLevel",value:function(t){i.CLog.logLevel=t}},{key:"getConsoleLogLevel",value:function(){return i.CLog.logLevel}},{key:"setBeaconServer",value:function(t,e){i.Util.isString(t)?(a.default.set("apiHost",t),(0,c.setErrorLoggerHost)(t),i.CLog.info("送信先ホスト変更成功",t)):i.Util.isNull(t)||i.Util.isUndefined(t)||i.CLog.warning("送信先ホスト変更失敗",t),i.Util.isString(e)?(a.default.set("apiPath",e),i.CLog.info("送信先パス変更成功",e)):i.Util.isNull(e)||i.Util.isUndefined(e)||i.CLog.warning("送信先パス変更失敗",e)}},{key:"setAccessToken",value:function(t){i.Util.isString(t)&&(a.default.set("apiAccessToken",t),(0,c.setErrorLoggerAccessToken)(t),i.CLog.info("[アクセストークン変更]",t))}},{key:"enableSecureTransport",value:function(t){!0===t?a.default.set("apiScheme","https://"):!1===t&&(a.default.set("apiScheme","http://"),i.CLog.warning("通信にHTTPを利用します"))}},{key:"enableSendBeacon",value:function(t){!0===t?(a.default.set("sendBeaconEnabled",!0),i.CLog.info("通信にsendBeaconまたはXHRを利用します")):!1===t?(a.default.set("sendBeaconEnabled",!1),i.CLog.info("通信にsendBeaconを利用せずXHRのみ利用します")):i.CLog.warning("boolean型の値を指定してください")}},{key:"enableErrorLogging",value:function(t){!0===t?(a.default.set("errorLoggingEnabled",!0),i.CLog.info("コアロガー内のエラーメトリクスロギングを有効化します")):!1===t?(a.default.set("errorLoggingEnabled",!1),i.CLog.info("コアロガー内のエラーメトリクスロギングを無効化します")):i.CLog.warning("boolean型の値を指定してください")}},{key:"setTargetProtocols",value:function(t){if(i.Util.isArray(t))if(t.length>0)if((t=t.filter((function(t){return i.Util.isString(t)}))).length>0){var e=t.map((function(t){return(t.endsWith(":")?t:t.concat(":")).toLocaleLowerCase()}));a.default.set("targetProtocols",e),i.CLog.info("ロギング対象プロトコル変更",e)}else i.CLog.error("プロトコル名はstring型の値にしてください. プロトコル設定を行いませんでした");else a.default.set("targetProtocols",["http:","https:"]),i.CLog.info("ロギング対象プロトコルをデフォルトにリセット",a.default.get("targetProtocols"));else i.CLog.error("引数には配列を指定してください. プロトコル設定を行いませんでした")}},{key:"send",value:function(t){(0,c.sendDebug)("core.send#start"),i.Util.isObject(t)?-1!==a.default.get("targetProtocols").indexOf(window.location.protocol)?(s.push(t.token,t.project,t.dataset,t.data),i.Util.isUndefined(t.flush)||i.Util.isBoolean(t.flush)||i.CLog.warning("flushオプションが期待するのはboolean型です"),!0===t.flush?this.flush(t.callback):y.setTimer(),(0,c.sendDebug)("core.send#end")):i.CLog.error("現在開いているページの "+window.location.protocol+" プロトコルはロギング対象外です。"):i.CLog.error("引数の型が不正")}},{key:"flush",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,c.sendDebug)("core.flush#start"),i.Util.isFunction(t)?s.send(t):(i.Util.isNull(t)||i.CLog.warning("callbackには関数を指定してください"),s.send()),(0,c.sendDebug)("core.flush#end")}},{key:"getSdkName",value:function(){return a.default.get("sdkName")}},{key:"getSdkVersion",value:function(){return a.default.get("sdkVersion")}},{key:"getPageSession",value:function(){return(0,f.default)()}}],n&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();(0,c.sendDebug)("core#end"),e.default=p},624:function(t,e,n){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0});var o=n(751),i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"getDefaultHost",value:function(){var t="dsb.yahoo.co.jp",e="undefined"!=typeof window?window.document:{},n=o.Util.getType(e);return/^(HTML)?Document$/.test(n)?new RegExp("".concat("yahoo.co.jp","$")).test(e.location.hostname)?t:"dsb.yahooapis.jp":t}}],n&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=i},646:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.setErrorLoggerHost=e.setErrorLoggerAccessToken=e.sendDebug=void 0;var o=r(n(514)),i=r(n(539)),u=r(n(13)),l={targetName:u.default.get("sdkName"),targetVersion:u.default.get("sdkVersion"),coreName:u.default.get("sdkName"),coreVersion:u.default.get("sdkVersion"),pageSession:(0,i.default)()},a=new o.default(l);e.sendDebug=function(t){!0===u.default.get("errorLoggingEnabled")&&a.debug({label:t})},e.setErrorLoggerAccessToken=function(t){a.setAccessToken(t)},e.setErrorLoggerHost=function(t){a.setHost(t)}},284:function(t,e,n){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.createXhrObject=void 0;var i=n(751),u=o(n(13)),l=n(646);function a(){var t=null;if("undefined"==typeof XMLHttpRequest)return null;try{if(!("withCredentials"in(t=new XMLHttpRequest)))return null;if("undefined"!=typeof XDomainRequest)return null}catch(t){return i.CLog.error("XMLHttpRequestオブジェクトの作成に失敗",t),null}return t}e.createXhrObject=a;var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"send",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,l.sendDebug)("HttpClient.send#start");var n="undefined"!=typeof window?window:{};u.default.get("sendBeaconEnabled")&&i.Util.isNull(e)&&"object"===r(n.navigator)&&i.Util.isFunction(n.navigator.sendBeacon)?this.sendBeacon(t):this.sendAjax(t,e),(0,l.sendDebug)("HttpClient.send#end")}},{key:"sendAjax",value:function(t,e){(0,l.sendDebug)("HttpClient.sendAjax#start");var n=a(),r=this.buildUrl(),o=function(){i.Util.isFunction(e)&&e()};if(!i.Util.isNull(n)){n.open("POST",r),n.withCredentials=!0,n.setRequestHeader("Content-Type","application/json;charset=UTF-8");var c=u.default.get("apiAccessToken");null!==c&&n.setRequestHeader("Authorization","Bearer ".concat(c)),!("timeout"in n)&&u.default.get("ajaxTimeout")?setTimeout((function(){n.abort(),o()}),u.default.get("ajaxTimeout")):n.timeout=u.default.get("ajaxTimeout"),n.onload=n.ontimeout=n.onerror=n.onabort=o,n.send(t),i.CLog.info("[送信]",r,t),(0,l.sendDebug)("HttpClient.sendAjax#end")}}},{key:"sendBeacon",value:function(t){(0,l.sendDebug)("HttpClient.sendBeacon#start");var e=this.buildUrl(!0);navigator.sendBeacon(e,t),i.CLog.info("[送信]",e,t),(0,l.sendDebug)("HttpClient.sendBeacon#end")}},{key:"buildUrl",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e="";e+=u.default.get("apiScheme"),e+=u.default.get("apiHost"),e+=u.default.get("apiPath");var n=u.default.get("apiAccessToken");return null!==n&&t&&(e+="?access_token=".concat(n)),e}}],n&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=c},539:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=r(n(834));e.default=function(){return"undefined"==typeof window?"":(window.YAS=window.YAS||{},window.YAS.psid=window.YAS.psid||(0,o.default)(),window.YAS.psid)}},909:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if("undefined"==typeof window||void 0===window.document)return!1;var e=document.createElement("link");return e.setAttribute("rel","preconnect"),e.setAttribute("href",t),document.head.appendChild(e),!0}},305:function(t,e,n){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=n(751),l=i(n(13)),a=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.buffer=e,this.shortInterval=o||l.default.get("shortTimerInterval"),this.longInterval=r||l.default.get("longTimerInterval"),this.shortTimer=null,this.longTimer=null,this.leaveCallback=function(t){var e;"visibilitychange"===t.type&&"hidden"!==(null===(e=document)||void 0===e?void 0:e.visibilityState)||(u.CLog.debug("fire inactive event. type = ".concat(t.type)),n.buffer.queue.length>0&&(n.buffer.send(),n.clearAllTimer()))};var i="undefined"!=typeof window?window:{};u.Util.is("Window",i)&&u.Util.isFunction(i.addEventListener)?t.INACTIVE_EVENTS.forEach((function(t){i.addEventListener(t,n.leaveCallback,!1)})):u.CLog.warning("not hook a leave event."),this.createNetWorkStateHandler(),this.setInitialNetWork(),this.setNetWorkWatcher()}var e,n,i;return e=t,i=[{key:"INACTIVE_EVENTS",get:function(){return["blur","pagehide","visibilitychange","beforeunload","unload"]}}],(n=[{key:"createNetWorkStateHandler",value:function(){var t=this;this.onlineHandler=function(){t.buffer.online=!0,t.buffer.queue.length>0&&t.buffer.send()},this.offlineHandler=function(){t.buffer.online=!1}}},{key:"setInitialNetWork",value:function(){var t="undefined"!=typeof window?window:{};u.Util.is("Window",t)&&"object"===r(t.navigator)&&u.Util.isBoolean(t.navigator.onLine)?this.buffer.online=t.navigator.onLine:this.buffer.online=!0}},{key:"setNetWorkWatcher",value:function(){var t="undefined"!=typeof window?window:{};u.Util.isFunction(t.addEventListener)&&(t.addEventListener("online",this.onlineHandler,!1),t.addEventListener("offline",this.offlineHandler,!1))}},{key:"setTimer",value:function(){var t=this;u.Util.isNull(this.shortTimer)||(clearTimeout(this.shortTimer),this.shortTimer=null),this.shortTimer=setTimeout((function(){t.buffer.send(),t.clearAllTimer(),u.CLog.debug("Called: short timer fire.")}),this.shortInterval),u.Util.isNull(this.longTimer)&&(this.longTimer=setTimeout((function(){t.buffer.send(),t.clearAllTimer(),u.CLog.debug("Called: long timer fire.")}),this.longInterval))}},{key:"clearAllTimer",value:function(){clearTimeout(this.shortTimer),clearTimeout(this.longTimer),this.shortTimer=null,this.longTimer=null}}])&&o(e.prototype,n),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=a},834:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}},808:function(t){"use strict";t.exports=JSON.parse('{"name":"YASCoreLogger-web","version":"4.0.2"}')}},n={},function t(r){var o=n[r];if(void 0!==o)return o.exports;var i=n[r]={exports:{}};return e[r].call(i.exports,i,i.exports,t),i.exports}(309).default)}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var r={};return function(){"use strict";n.d(r,{default:function(){return Nn}});var t=n(751),e={string:function(e){return t.Util.normalizeToString(e)},number:function(e){return t.Util.normalizeToNumber(e,null)},boolean:function(t){return Boolean(t)},array:function(e){return t.Util.isArray(e)?e:null}},o="data-ual",i="data-ual-view-type",u="data-ual-gotocontent",l="data-ual-gotodigest-noflow",a="data-ual-gotocontent-noflow",c="data-ual-content-key",f="data-ual-new-data",s="data-ual-update-data",y={list:"list",digest:"digest",detail:"detail",internal:"internal"},p=function(e){if(!t.Util.isString(e)||t.Util.isEmpty(e))return[];var n=e.split(":");return[n.shift().trim(),n.join(":").trim()]},d=function(e,n){return!t.Util.isArray(n)||n.length<=1?e:t.Util.isString(n[0])&&!t.Util.isEmpty(n[0])&&t.Util.isString(n[1])?(e[n[0]]=n[1],e):e},v=function(e){var n=t.Util.getType(e);return/^HTML.*Element$/.test(n)},m=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},b=v,g=function(e){return t.Util.is("Window",e)},h=function(e){var n=t.Util.getType(e);return/^(HTML)?Document$/.test(n)},w=m,S=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!v(e))return{};var r=n||o,i=e.getAttribute(r);return t.Util.isNull(i)?{}:i.split(";").map(p).reduce(d,{})},j=function(t){var e=[];for(var n in t)w(t,n)&&e.push(n);return e},k=function(n,r){var o=r[0],i=r[1],u=r[2],l=function(n,r){return t.Util.isUndefined(r)||t.Util.isNull(r)||t.Util.isUndefined(e[n])?null:e[n](r)}(u,i);return t.Util.isNull(l)?(t.CLog.warning("[Validator#run] ".concat(o,"に").concat(u,"型に変換出来ない値(").concat(i,")が指定されています")),n):(n[o]=l,n)},C={ruleSets:{},aliasMap:{},addRuleSet:function(e,n){var r=this;if(t.Util.isString(e)&&!t.Util.isEmpty(e))if(t.Util.isObject(n)){var o=j(n).reduce((function(e,o){var i=n[o];return t.Util.isUndefined(i.alias)||(r.aliasMap[i.alias]=o),e[o]={type:i.type},e}),{});this.ruleSets[e]=o}else t.CLog.error("[Validator#addRule] 不正なRuleSet",n);else t.CLog.error("[Validator#addRule] 不正なアクションID",e)},run:function(e,n){var r=this;if(!t.Util.isString(e)||t.Util.isEmpty(e))return t.CLog.error("[Validator#run] アクションIDが不正",e),null;if(t.Util.isUndefined(this.ruleSets[e]))return t.CLog.error("[Validator#run] アクション ".concat(e," に紐付くルールセットが未登録"),this.ruleSets),null;if(!t.Util.isObject(n))return t.CLog.error("[Validator#run] データの形式が不正",n),null;var o=this.ruleSets[e],i=j(o);return j(n).map((function(t){var e=r.aliasMap[t]||t;return-1!==i.indexOf(e)?[e,n[t],o[e].type]:null})).filter(t.Util.isArray).reduce(k,{})}},_={viewStart:{list:"view_content_list_start",detail:"view_content_detail_start",digest:"view_content_digest_start"},viewEnd:{list:"view_content_list_end",detail:"view_content_detail_end",digest:"view_content_digest_end"},flow:"go_to_content",view_video_start:"view_video_start",view_video_end:"view_video_end",pageview:"pageview",cv:"cv",search:"search"},O={ts:{type:"number"},action_id:{type:"string"},content_id:{type:"string",alias:"contid"},id_type:{type:"string",alias:"idtype"},page_session:{type:"string"},url:{type:"string"},service:{type:"string"},apptype:{type:"string"},opttype:{type:"string"},os:{type:"string"},sdk:{type:"string"},sdk_ver:{type:"string"},extension:{type:"string"},extension_ver:{type:"string"},mtestid:{type:"string"},ss_join_id:{type:"string"},ss_join_id_type:{type:"string"},referer:{type:"string"}},U={element_id:{type:"string"}},P=t.Util.merge({},U),T=t.Util.merge({start_time:{type:"number"},end_time:{type:"number"},view_time:{type:"number"},view_rate:{type:"number"}},U),E={current_page:{type:"number"}},L=t.Util.merge({total_page:{type:"number"}},E),x={list:t.Util.merge(T,{viewable_time:{type:"number"}}),detail:t.Util.merge(T,L),digest:t.Util.merge(T,{})},A=t.Util.merge({video_id:{type:"string"},autoplay:{type:"boolean"},start_time_position:{type:"number"}},U),N=t.Util.merge(A,{}),M=t.Util.merge(A,{end_time_position:{type:"number"}}),D=t.Util.merge({href:{type:"string"}},U),R=t.Util.merge({origin_query:{type:"string"},result_query:{type:"string"},entities:{type:"array"},search_type:{type:"string"},page_type:{type:"string"},hierarchy_id:{type:"string"}},E),I=_.viewStart,B=_.viewEnd,F={};F[I.list]=t.Util.merge(O,P),F[I.detail]=t.Util.merge(O,P),F[I.digest]=t.Util.merge(O,P),F[B.list]=t.Util.merge(O,x.list),F[B.detail]=t.Util.merge(O,x.detail),F[B.digest]=t.Util.merge(O,x.digest),F[_.view_video_start]=t.Util.merge(O,N),F[_.view_video_end]=t.Util.merge(O,M),F[_.flow]=t.Util.merge(O,D),F[_.pageview]=t.Util.merge(O,{nopv:{type:"boolean"},hierarchy_id:{type:"string"}}),F[_.cv]=t.Util.merge(O,{cv_id:{type:"string"}}),F[_.search]=t.Util.merge(O,R);var H=F,V=n(295),q=n.n(V),W=q().getPageSession(),z=function(){return h(document)?document.URL:null},G=function(){if(e=navigator,null===t.Util.getType(e).match(/^Navigator$/))return t.CLog.error("[osName()] navigatorオブジェクトが存在しません"),null;var e,n=navigator.userAgent,r="other";return n.match(/windows\sphone/i)?r="windowsphone":n.match(/windows/i)?r="windows":n.match(/iphone|ipad/i)?r="ios":n.match(/mac|ppc/i)?r="mac":n.match(/android/i)&&(r="android"),r},J=q().getSdkName(),X=q().getSdkVersion();function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==$(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===$(o)?o:String(o)),r)}var o}var K=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.config={project:null,actionList:[],extensionName:null,extensionVersion:null}}var e,n;return e=t,n=[{key:"setToken",value:function(t){"token"in this.config||(this.config.token=t)}},{key:"getToken",value:function(){return"token"in this.config?this.config.token:null}},{key:"setProject",value:function(t){this.config.project=t}},{key:"getProject",value:function(){return this.config.project}},{key:"setExtensionName",value:function(t){this.config.extensionName=t}},{key:"getExtensionName",value:function(){return this.config.extensionName}},{key:"setExtensionVersion",value:function(t){this.config.extensionVersion=t}},{key:"getExtensionVersion",value:function(){return this.config.extensionVersion}},{key:"setActionList",value:function(t){this.config.actionList=t}},{key:"isValidAction",value:function(t){return-1!==this.config.actionList.indexOf(t)}},{key:"hasContentAction",value:function(){var t,e=Object.keys(_.viewStart).map((function(t){return _.viewStart[t]})),n=Object.keys(_.viewEnd).map((function(t){return _.viewEnd[t]})),r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){l=!0,i=t},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}([_.flow].concat(e).concat(n));try{for(r.s();!(t=r.n()).done;){var o=t.value;if(this.isValidAction(o))return!0}}catch(t){r.e(t)}finally{r.f()}return!1}}],n&&Y(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Z=new K;function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==tt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===tt(o)?o:String(o)),r)}var o}var nt=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"buildCommonParameters",value:function(){return{content_id:null,id_type:null,service:null,apptype:"web",opttype:null,mtestid:null,ss_join_id:null,ss_join_id_type:null,referer:h(document)?document.referrer:null}}},{key:"buildActionParameters",value:function(t){return{}}},{key:"buildGlobalParameters",value:function(e){return t.Util.isObject(e)&&t.Util.isFunction(e.getParameters)?e.getParameters():{}}},{key:"buildContentParameters",value:function(e){return t.Util.isObject(e)&&t.Util.isFunction(e.getParameters)?e.getParameters():{}}},{key:"buildFixedParameters",value:function(e,n){return{ts:t.Util.getTime(),action_id:e,page_session:W,url:z(),os:G(),sdk:J,sdk_ver:X,extension:Z.getExtensionName(),extension_ver:Z.getExtensionVersion()}}},{key:"run",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t.Util.isObject(this.validator)||!t.Util.isFunction(this.validator.run))return t.CLog.error("[BaseBuilder.run] バリデータが未登録か不正です.",this.validator),null;var o=this.buildCommonParameters(),i=this.buildActionParameters(r),u=this.buildGlobalParameters(n),l=this.buildContentParameters(r),a=this.buildFixedParameters(e,r);t.CLog.debug("[BaseBuilder#run] Parameters:","common = ",o,"action = ",i,"global = ",u,"content = ",l,"fixed = ",a);var c=t.Util.merge(o,i,u,l,a);return this.validator.run(e,c)}}],null&&et(n.prototype,null),r&&et(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();nt.validator=null;var rt=nt;function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==ot(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ot(o)?o:String(o)),r)}var o}function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==ut(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ut(o)?o:String(o)),r)}var o}var at={},ct=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.parameters={}}var e,n;return e=t,(n=[{key:"addParameter",value:function(t,e){this.parameters[t]=e}},{key:"getParameters",value:function(){return this.parameters}}])&&it(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()),ft=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"viewStart",value:function(t){this.dispatch("viewStart",t)}},{key:"viewEnd",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.dispatch("viewEnd",t,e)}},{key:"flow",value:function(t,e){t.setFlowInfo(e),this.dispatch("flow",t),t.unsetFlowInfo()}},{key:"hit",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.dispatch(t,e,n)}},{key:"dispatch",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t.Util.isString(e))return null;var r=_[e];if(t.Util.isString(r))return r;if(!t.Util.isObject(r)||!t.Util.isString(n.viewType))return null;var o=r[n.viewType];return t.Util.isString(o)?o:null}(e,n);if(t.Util.isString(o))if(Z.isValidAction(o))if(t.Util.isUndefined(at[o]))t.CLog.error("[LogDispatcher#dispatch] アクションIDに対し適切なビルダーが設定されていません",o);else{var i=at[o].run(o,ct,n);null!==i&&q().send({token:Z.getToken(),project:Z.getProject(),dataset:o,data:i,flush:r})}else t.CLog.error("[LogDispatcher#hit] 対象のアクションはロギング対象ではありません",o);else t.CLog.error("[LogDispatcher#dispatch] 該当するアクションIDが存在しません",o,n)}},{key:"addBuilder",value:function(e,n){if(!t.Util.isString(e)||t.Util.isEmpty(e))return t.CLog.error("[LogDispatcher#addBuilder] アクションIDには空でない文字列を指定してください","actionId = ".concat(e)),!1;if(!t.Util.isUndefined(at[e]))return t.CLog.error("[LogDispatcher#addBuilder] 登録済みのアクションIDです.","actionId = ".concat(e)),!1;for(var r=n;null!==r&&(r=Object.getPrototypeOf(r))!==rt;);return n!==rt&&null===r?(t.CLog.error("[LogDispatcher#addBuilder] ビルダーはBaseBuilder, またはそのサブクラスとしてください.","actionId = ".concat(e)),!1):(at[e]=n,!0)}},{key:"addGlobalData",value:function(t){for(var e in t)w(t,e)&&ct.addParameter(e,t[e])}},{key:"getToken",value:function(){return Z.getToken()}},{key:"setBroker",value:function(t,e){q().setBeaconServer(t,e)}},{key:"setAccessToken",value:function(t){q().setAccessToken(t)}},{key:"removeBuilder",value:function(t){delete at[t]}}],null&&lt(n.prototype,null),r&&lt(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(),st=ft;function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==yt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===yt(o)?o:String(o)),r)}var o}function dt(t,e){return dt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},dt(t,e)}function vt(t){return vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vt(t)}var mt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dt(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=vt(r);if(o){var n=vt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===yt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i.apply(this,arguments)}return e=u,n=[{key:"buildActionParameters",value:function(t){var e=t.viewType;return{start_time:t.viewStartTime,end_time:t.viewEndTime,view_time:t.viewEndTime-t.viewStartTime,viewable_time:e===y.list?t.viewableTime:null,view_rate:t.readProportion,current_page:null,total_page:null}}}],null&&pt(e.prototype,null),n&&pt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(rt),bt=mt;function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==gt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==gt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===gt(o)?o:String(o)),r)}var o}function wt(t,e){return wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},wt(t,e)}function St(t){return St=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},St(t)}var jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wt(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=St(r);if(o){var n=St(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===gt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i.apply(this,arguments)}return e=u,n=[{key:"buildActionParameters",value:function(t){return{href:t.url}}}],null&&ht(e.prototype,null),n&&ht(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(rt),kt=jt;function Ct(t){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ct(t)}function _t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Ct(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Ct(o)?o:String(o)),r)}var o}function Ot(t,e){return Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ot(t,e)}function Ut(t){return Ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ut(t)}var Pt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ot(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ut(r);if(o){var n=Ut(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ct(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i.apply(this,arguments)}return e=u,n=[{key:"buildActionParameters",value:function(t){return{nopv:!1}}}],null&&_t(e.prototype,null),n&&_t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(rt),Tt=Pt;function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}var Lt=function(){var e=t.Util.urlQueryString(z()),n=t.Util.urlQueryParse(e),r=null;return["p","q","query"].some((function(t){if("object"===Et(n)&&w(n,t))return e=n[t],r=decodeURIComponent(e.replace(/\+/g,"%20")),!0;var e})),r};function xt(t){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xt(t)}function At(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==xt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==xt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===xt(o)?o:String(o)),r)}var o}function Nt(t,e){return Nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Nt(t,e)}function Mt(t){return Mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mt(t)}var Dt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nt(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Mt(r);if(o){var n=Mt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===xt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i.apply(this,arguments)}return e=u,n=[{key:"buildActionParameters",value:function(t){return{origin_query:Lt()}}}],null&&At(e.prototype,null),n&&At(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(rt),Rt=Dt,It=_.viewStart,Bt=_.viewEnd,Ft={};Ft[It.list]=rt,Ft[It.detail]=rt,Ft[It.digest]=rt,Ft[Bt.list]=bt,Ft[Bt.detail]=bt,Ft[Bt.digest]=bt,Ft[_.view_video_start]=rt,Ft[_.view_video_end]=rt,Ft[_.flow]=kt,Ft[_.pageview]=Tt,Ft[_.cv]=rt,Ft[_.search]=Rt;var Ht=Ft,Vt="ual.modulechange";function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function Wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==qt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===qt(o)?o:String(o)),r)}var o}var zt=function(){function e(n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.isActive=!1,this.interval=t.Util.isNumber(n)?n:100}var n,r;return n=e,(r=[{key:"monitor",value:function(){return!0}},{key:"runTimer",value:function(){var t=this;this.isActive&&(this.monitor(),setTimeout((function(){t.runTimer()}),this.interval))}},{key:"start",value:function(){this.isActive||(this.isActive=!0,this.runTimer())}},{key:"stop",value:function(){this.isActive=!1}}])&&Wt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(),Gt=function(){return g(window)?{w:innerWidth,h:innerHeight}:{w:0,h:0}},Jt=function(t){var e=t.getBoundingClientRect();return{x:e.left,y:e.top,r:e.right,b:e.bottom,w:e.width,h:e.bottom-e.top}},Xt=function(e,n){var r=(n=t.Util.isObject(n)?n:{}).top||0,o=n.bottom||0;return{x:0,y:r,r:e.w,b:e.h-o,w:e.w,h:e.h-r-o}},$t=function(e,n,r,o){if(!g(window))return t.CLog.error("[visibility.isHiddenElement] windowオブジェクトが存在しません"),!0;var i=getComputedStyle(e);if("hidden"===i.getPropertyValue("visibility")||"none"===i.getPropertyValue("display"))return!0;var u=Xt(n,o);return r.x>=u.r||r.r<=u.x||r.y>=u.b||r.b<=u.y},Qt=function(t,e,n){var r=Xt(t,n),o=Math.max(r.x,e.x),i=Math.min(e.r,r.r),u=Math.max(r.y,e.y),l=Math.min(r.b,e.b);return{x:o,y:u,r:i,b:l,w:i-o,h:l-u}},Yt={none:0,start:1,end:2};function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function Zt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Kt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Kt(o)?o:String(o)),r)}var o}var te=Yt,ee=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.cp=S(n),this.mp=S(r),this.lp={},this.hp={},this.vt=function(e){if(!v(e))return null;var n=e.getAttribute(i);if(!t.Util.isString(n)||t.Util.isEmpty(n))return null;for(var r in y)if(m(y,r)&&y[r]===n)return n;return null}(n),null===this.vt&&t.CLog.error("[ContentDataModel.constructor] 規定外の表示種別",n),this.vap=0,this.vst=0,this.vet=0,this.vast=null,this.vat=this.vt===y.list?0:null,this.rpf=[];for(var o=0;o<100;o++)this.rpf[o]=!1;this.href=null}var n,r;return n=e,r=[{key:"getParameters",value:function(){return t.Util.merge({},this.mp,this.cp,this.lp,this.hp)}},{key:"setHitParameters",value:function(e){this.hp=t.Util.isObject(e)?e:{}}},{key:"setFlowInfo",value:function(t){for(var e=[u,l,a],n=null,r=0;r<e.length;r++)if(t.hasAttribute(e[r])){n=e[r];break}this.lp=S(t,n),n===u?this.href=t.href:n!==a&&n!==l||(this.href=document.URL)}},{key:"unsetFlowInfo",value:function(){this.lp={},this.href=null}},{key:"viewType",get:function(){return this.vt}},{key:"viewStartTime",get:function(){return this.vst}},{key:"viewEndTime",get:function(){return this.vet}},{key:"viewableTime",get:function(){return this.vat}},{key:"readProportion",get:function(){return this.rpf.filter((function(t){return t})).length}},{key:"url",get:function(){var e=this.href;return t.Util.isString(e)&&!t.Util.isEmpty(e)?e:null}},{key:"update",value:function(e){var n=te.none;return t.Util.isNumber(e)?(0===this.vap&&0!==e?(this.vst=t.Util.getTime(),n=te.start):0!==this.vap&&0===e&&(this.vet=t.Util.getTime(),n=te.end),this.vt===y.list&&(null===this.vast&&e>=50?this.vast=t.Util.getTime():null!==this.vast&&e<50&&(this.vat+=t.Util.getTime()-this.vast,this.vast=null)),this.vap=e,n):(t.CLog.error("[ContentDataModel#update] 可視面積比率の値が不正",e),n)}},{key:"read",value:function(t,e){for(var n=t;n<=e;n++)this.rpf[n]=!0}}],r&&Zt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(),ne=ee;function re(t){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},re(t)}function oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==re(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===re(o)?o:String(o)),r)}var o}var ie=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.top=0,this.bottom=0}var n,r;return n=e,r=[{key:"getOffset",value:function(){return{top:this.top,bottom:this.bottom}}},{key:"setOffset",value:function(e){this.top=t.Util.isObject(e)&&t.Util.isNumber(e.top)?e.top:0,this.bottom=t.Util.isObject(e)&&t.Util.isNumber(e.bottom)?e.bottom:0}}],r&&oe(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(),ue=ie,le=!1;function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function ce(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==ae(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ae(o)?o:String(o)),r)}var o}function fe(t,e){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},fe(t,e)}function se(t,e){if(e&&("object"===ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ye(t){return ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ye(t)}var pe,de=c,ve=Yt,me=function(e,n,r,o,i){var u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=null,c=0,f=i instanceof ue?i.getOffset():{};b(n)&&(a=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!b(e))return t.CLog.error("[visibility.getReadRange] 不正な引数",e),null;var r=Gt(),o=Jt(e);if($t(e,r,o,n))return null;var i=o.y,u=o.h,l=i+u,a=Qt(r,o,n),c=(a.y-i)/u*100,f=(u-(l-a.b))/u*100;return f-c<1?null:{start:Math.ceil(c),end:Math.floor(f)-1}}(n,f),c=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!b(e))return t.CLog.error("[visibility.getVAP] 不正な引数",e),0;var r=Gt(),o=Jt(e);if($t(e,r,o,n))return 0;var i=o.w*o.h,u=Qt(r,o,n);return u.w*u.h/i*100}(n,f)),null!==a&&e.read(a.start,a.end);var s=e.update(c);if(s!==ve.end&&l&&(s=e.update(0)),s===ve.start)t.Util.isFunction(r)&&r(e);else if(s===ve.end)return t.Util.isFunction(o)&&o(e,u),null;return function(t,e){if(b(t))if(le){var n=function(t){var e=t.querySelector(".uainfo");if(null!==e)return e;var n=document.createElement("div");return n.className="uainfo",n.style.position="absolute",n.style.backgroundColor="rgba(0,0,0,0.4)",n.style.color="#FFF",n.style.padding="3px",n.style.left=0,n.fontSize="13pt",n.zIndex="100000",t.appendChild(n),n}(t);!function(t,e){t.innerHTML="";var n=e.getParameters(),r=n.content_id||n.contid||null;null!==r&&(t.innerHTML+="".concat(r.substr(0,12),"<br>"));var o=e.vap,i=e.readProportion;t.innerHTML+="".concat("".concat(o).substr(0,5),"%<br>ViewRate:").concat(i,"%<br>");var u=e.viewStartTime,l=u>0?Math.floor(((new Date).getTime()-u)/1e3):0;t.innerHTML+="ViewTime:".concat(l,"秒")}(n,e),function(t,e){if(!t.hasAttribute("data-ual-debug-style")){var n={borderColor:t.style.borderColor,borderWidth:t.style.borderWidth,borderStyle:t.style.borderStyle};t.setAttribute("data-ual-debug-style",JSON.stringify(n))}e.vap>0?(t.style.borderColor="red",t.style.borderWidth="1px",t.style.borderStyle="solid"):(t.style.borderColor="rgba(0,0,0,0)",t.style.borderWidth="1px",t.style.borderStyle="solid")}(t,e)}else!function(t){var e=t.querySelector(".uainfo");null!==e&&t.removeChild(e);var n=t.getAttribute("data-ual-debug-style");if(null!==n){var r=JSON.parse(n);for(var o in r)w(r,o)&&(t.style[o]=r[o]);t.removeAttribute("data-ual-debug-style")}}(t)}(n,e),e},be=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fe(t,e)}(d,e);var n,r,u,c,p=(u=d,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ye(u);if(c){var n=ye(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return se(this,t)});function d(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(n=p.call(this,r)).module=null,!t.Util.isString(e)||t.Util.isEmpty(e))return t.CLog.error("[ContentMonitor.constructor] モジュールIDは空でない文字列で指定してください.",e),se(n);var o=document.getElementById(e);return b(o)?(n.module=o,n.contentDataMap={},n.startHandler=null,n.endHandler=null,n.offsetData=null,n):(t.CLog.error("[ContentMonitor.constructor] 指定されたモジュールが存在しません.",e),se(n))}return n=d,r=[{key:"monitor",value:function(){var e=this;if(null===this.module)return!1;var n=this.module.querySelectorAll("[".concat(o,"]")),r=Array.prototype.slice.call(n),i=r.filter((function(t){return t.hasAttribute(de)})).reduce((function(n,r){return t.Util.merge(n,e.reuseContentData(r))}),{}),u=r.filter((function(t){return!t.hasAttribute(de)})),l=u.reduce((function(n,r){return t.Util.merge(n,e.createContentData(r))}),{});return t.Util.isEmpty(u)||this.module.dispatchEvent(function(t){try{return new Event(t)}catch(n){var e=document.createEvent("Event");return e.initEvent(t,!1,!1),e}}(Vt)),this.finalize(),this.contentDataMap=t.Util.merge(i,l),!0}},{key:"flush",value:function(){var t=this;if(null===this.module)return!1;var e=this.module.querySelectorAll("[".concat(o,"]"));return Array.prototype.slice.call(e).forEach((function(e){t.flushContentData(e,!0),e.removeAttribute(de)})),this.contentDataMap={},!0}},{key:"createContentData",value:function(t){var e={},n=new ne(t,this.module);if(null===n.viewType)return e;var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".split("").map((function(t){if("x"!==t&&"y"!==t)return t;var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})).join("");return t.setAttribute(de,r),e[r]=me(n,t,this.startHandler,this.endHandler,this.offsetData),e}},{key:"reuseContentData",value:function(e){var n=e.getAttribute(de);if(t.Util.isUndefined(this.contentDataMap[n]))return{};var r=this.contentDataMap[n];delete this.contentDataMap[n];var o={};return o[n]=me(r,e,this.startHandler,this.endHandler,this.offsetData),null===o[n]?(e.removeAttribute(de),{}):o}},{key:"flushContentData",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.getAttribute(de);t.Util.isUndefined(this.contentDataMap[r])||(me(this.contentDataMap[r],e,this.startHandler,this.endHandler,this.offsetData,n,!0),delete this.contentDataMap[r])}},{key:"replaceContentData",value:function(e,n){this.flushContentData(e),this.updateContentElement(e,n),this.contentDataMap=t.Util.merge(this.contentDataMap,this.createContentData(e))}},{key:"updateContentElement",value:function(e,n){if(n.hasAttribute(l)?e.setAttribute(i,y.digest):n.hasAttribute(a)&&e.setAttribute(i,y.detail),null!==n.getAttribute(f))e.setAttribute(o,n.getAttribute(f));else if(null!==n.getAttribute(s)){var r=S(e,o),u=S(n,s);!function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o;if(v(e)&&t.Util.isObject(n)&&t.Util.isString(r)&&""!==r){var i=[];for(var u in n)m(n,u)&&i.push(u);var l=i.reduce((function(e,r){return e.push("".concat(t.Util.normalizeToString(r),":").concat(t.Util.normalizeToString(n[r]))),e}),[]).join(";");e.setAttribute(r,l)}}(e,t.Util.merge(r,u))}}},{key:"finalize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.contentDataMap;for(var n in e)if(w(e,n)){var r=e[n];me(r,null,null,this.endHandler,this.offsetData,t)}}}],r&&ce(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),d}(zt),ge=be,he={isHidden:!1},we=[],Se=[],je=["focus","pageshow"],ke=["blur","pagehide","beforeunload","unload"],Ce=function(){he.isHidden&&(we.forEach((function(t){return t()})),he.isHidden=!1)},_e=function(){he.isHidden||(Se.forEach((function(t){return t()})),he.isHidden=!0)},Oe=function(){document[pe]?_e():Ce()},Ue=function(){we.splice(0,we.length),Se.splice(0,Se.length)},Pe=[],Te=[],Ee=["yjsmhSidebarClose","yjsmhNotificationMenuClose"],Le=["yjsmhSidebarOpen","yjsmhNotificationMenuOpen"],xe=function(){he.isHidden&&(Pe.forEach((function(t){return t()})),he.isHidden=!1)},Ae=function(){he.isHidden||(Te.forEach((function(t){return t()})),he.isHidden=!0)},Ne=function(){Pe.splice(0,Pe.length),Te.splice(0,Te.length)},Me=[],De=function(t){for(var e=t.target;e&&!e.hasAttribute(u)&&!e.hasAttribute(l)&&!e.hasAttribute(a);)e=e.parentNode;Me.forEach((function(t){return t(e)}))},Re=function(t){if(b(t)){var e="a[".concat(u,"], [").concat(l,"], [").concat(a,"]"),n=t.querySelectorAll(e);Array.prototype.slice.call(n).forEach((function(t){t.removeEventListener("click",De,!0),t.addEventListener("click",De,!0)}))}},Ie=function(){Me.splice(0,Me.length)};function Be(t){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Be(t)}function Fe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Be(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Be(o)?o:String(o)),r)}var o}function He(t,e){return He=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},He(t,e)}function Ve(t){return Ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ve(t)}var qe=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&He(t,e)}(l,e);var n,r,o,i,u=(o=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ve(o);if(i){var n=Ve(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Be(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function l(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(t=u.call(this,e)).offsetData=new ue,t}return n=l,(r=[{key:"monitor",value:function(){var e=function(){if(!g(window)||!h(document))return t.CLog.error("[util/offset.getOffset] windowまたはdocumentオブジェクトが存在しません"),null;var e=function(){var t=document.body.getElementsByTagName("*"),e=[];for(var n in t)if(w(t,n)){var r=t[n],o=getComputedStyle(r);"fixed"===o.position&&"none"!==o.display&&"hidden"!==o.visibility&&e.push(r)}return e}(),n=innerWidth/2,r=innerHeight,o=r/2,i=e.map((function(t){return t.getBoundingClientRect()})).filter((function(t){return t.width>n&&t.height>0}));return{top:i.filter((function(t){return t.bottom<o})).map((function(t){return t.bottom})).reduce((function(t,e){return Math.max(t,e)}),0),bottom:i.filter((function(t){return t.top>o})).map((function(t){return t.top})).reduce((function(t,e){return Math.max(t,r-e)}),0)}}();return this.offsetData.setOffset(e),!0}}])&&Fe(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),l}(zt),We=qe;function ze(t){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ze(t)}function Ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==ze(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ze(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ze(o)?o:String(o)),r)}var o}var Je=function(t){var e=$e().reduce((function(e,n){return e||(n.contentDataMap[t]?n:null)}),null);return e},Xe=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"addModule",value:function(n){var r=e.monitorMap;if(!t.Util.isUndefined(r[n]))return t.CLog.error("[Dispatcher#addModule] 登録済みのモジュールです.",n),!1;var o=new ge(n);return null===o.module?(t.CLog.error("[Dispatcher#addModule] ContentMonitorの生成に失敗しました. モジュールIDを確認してください",n),!1):(o.startHandler=e.handleViewStart,o.endHandler=e.handleViewEnd,o.offsetData=e.offsetMonitor.offsetData,o.module.addEventListener(Vt,(function(e){var n;n=e.currentTarget,t.Util.isArray(n)||(n=[n]),n.forEach(Re)})),r[n]=o,!0)}},{key:"startMonitors",value:function(){null!==st.getToken()?$e().forEach((function(t){t.start()})):t.CLog.error("[LogDispatcher#startMonitors] token が未設定です")}},{key:"stopMonitors",value:function(){$e().forEach((function(t){t.stop(),t.flush()}))}},{key:"handleViewStart",value:function(t){st.viewStart(t)}},{key:"handleViewEnd",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];st.viewEnd(t,e)}},{key:"handleFlow",value:function(t){e.startMonitors(),t.hasAttribute(l)||t.hasAttribute(a)?e.actionNoflow(t):t.hasAttribute(u)&&e.actionFlow(t)}},{key:"actionFlow",value:function(n){var r=e.findContentData(n);null!==r?(st.flow(r,n),e.stopMonitors()):t.CLog.error("[Dispatcher#actionFlow] 対応するコンテンツデータが見つかりません",n)}},{key:"actionNoflow",value:function(n){var r=e.findContentData(n);if(null!==r){st.flow(r,n);var o=e.findContentElement(n);if(null!==o){var i=o.getAttribute(c);Je(i).replaceContentData(o,n)}}else t.CLog.error("[Dispatcher#actionNoflow] 対応するコンテンツデータが見つかりません",n)}},{key:"findContentElement",value:function(t){for(var e=t;b(e);){if(e.hasAttribute(c))return e;e=e.parentNode}return null}},{key:"findContentData",value:function(n){var r=e.findContentElement(n);if(t.Util.isEmpty(r))return null;var o=r.getAttribute(c),i=Je(o);return t.Util.isEmpty(i)?null:i.contentDataMap[o]}},{key:"initMonitors",value:function(){var n,r,o,i=e.monitorMap;for(var u in i)w(i,u)&&delete i[u];Ue(),o=e.startMonitors,t.Util.isFunction(o)&&we.push(o),function(e){t.Util.isFunction(e)&&Se.push(e)}(e.stopMonitors),g(window)&&h(document)&&(je.forEach((function(t){removeEventListener(t,Ce),addEventListener(t,Ce,!1)})),ke.forEach((function(t){removeEventListener(t,_e),addEventListener(t,_e,!1)})),t.Util.isUndefined(document.hidden)&&!t.Util.isUndefined(document.webkitHidden)?(pe="webkitHidden",r="webkitvisibilitychange"):(pe="hidden",r="visibilitychange"),document.removeEventListener(r,Oe),document.addEventListener(r,Oe,!1)),Ne(),function(e){t.Util.isFunction(e)&&Pe.push(e)}(e.startMonitors),function(e){t.Util.isFunction(e)&&Te.push(e)}(e.stopMonitors),n=document.getElementById("wrapper"),t.Util.is("HTMLDivElement",n)&&(Ee.forEach((function(t){n.removeEventListener(t,xe),n.addEventListener(t,xe,!1)})),Le.forEach((function(t){n.removeEventListener(t,Ae),n.addEventListener(t,Ae,!1)}))),Ie(),function(e){t.Util.isFunction(e)&&Me.push(e)}(e.handleFlow)}},{key:"resetMonitors",value:function(){var t=e.monitorMap;for(var n in t)w(t,n)&&delete t[n];Ue(),Ne(),Ie()}}],null&&Ge(n.prototype,null),r&&Ge(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();Xe.offsetMonitor=new We,Xe.monitorMap={};var $e=function(){return function(t){var e=[];for(var n in t)w(t,n)&&e.push(t[n]);return e}(Xe.monitorMap)},Qe=Xe;function Ye(t){return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ye(t)}function Ke(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Ye(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Ye(o)?o:String(o)),r)}var o}var Ze=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"run",value:function(e){return!t.Util.isString(e)||t.Util.isEmpty(e)?(t.CLog.error("[CtrlCommander.run] サブコマンドの型または値が不正",e,"type: ".concat(Ye(e))),!1):t.Util.isFunction(this[e])?(this[e](),!0):(t.CLog.error("[CtrlCommander.run] 未定義のサブコマンド",e),!1)}},{key:"start",value:function(){Qe.startMonitors()}},{key:"stop",value:function(){Qe.stopMonitors()}}],null&&Ke(n.prototype,null),r&&Ke(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function tn(t){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tn(t)}function en(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==tn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==tn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===tn(o)?o:String(o)),r)}var o}var nn=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"addModule",value:function(e){return!1!==Qe.addModule(e)||(t.CLog.error("[InitCommander.run] モジュールの登録に失敗しました"),!1)}},{key:"validateModuleId",value:function(e){return!(!t.Util.isString(e)||t.Util.isEmpty(e))||(t.CLog.error("[InitCommander.run] 予期しないモジュールの指定",e),!1)}},{key:"run",value:function(e){var n=this;return t.Util.isArray(e)?t.Util.isEmpty(e)?(t.CLog.error("[InitCommander.run] 予期しないモジュールの指定",e),!1):!!e.every((function(t){return n.validateModuleId(t)}))&&e.reduce((function(t,e){return n.addModule(e)&&t}),!0):!!this.validateModuleId(e)&&this.addModule(e)}}],null&&en(n.prototype,null),r&&en(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function rn(t){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rn(t)}function on(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==rn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==rn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===rn(o)?o:String(o)),r)}var o}var un=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"run",value:function(e){if(!t.Util.isObject(e))return t.CLog.error("[OffsetCommander#run] 予期しないoptionsの型指定",e),!1;e.auto=!!t.Util.isBoolean(e.auto)&&e.auto,e.interval=t.Util.isNumber(e.interval)&&e.interval>0?e.interval:1e3,e.top=t.Util.isNumber(e.top)?e.top:0,e.bottom=t.Util.isNumber(e.bottom)?e.bottom:0;var n=Qe.offsetMonitor;return e.auto?(n.interval=e.interval,n.start()):(n.stop(),n.offsetData.setOffset({top:e.top,bottom:e.bottom})),!0}}],null&&on(n.prototype,null),r&&on(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(),ln=un;function an(t){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},an(t)}function cn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==an(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==an(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===an(o)?o:String(o)),r)}var o}var fn=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"run",value:function(e){return t.Util.isObject(e)?(st.addGlobalData(e),!0):(t.CLog.error("[GlobalCommander#run] 予期しないパラメータの型指定",e),!1)}}],null&&cn(n.prototype,null),r&&cn(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function sn(t){return sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sn(t)}function yn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==sn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==sn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===sn(o)?o:String(o)),r)}var o}var pn=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"run",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!t.Util.isString(e)||t.Util.isEmpty(e)?(t.CLog.error("[ConfigCommander#run] サブコマンドの型または値が不正",e,"type: ".concat(sn(e))),!1):t.Util.isFunction(this[e])?(this[e](n),!0):(t.CLog.error("[ConfigCommander#run] 未定義のサブコマンド",e),!1)}},{key:"token",value:function(t){Z.setToken(t)}},{key:"host",value:function(t){st.setBroker(t,null)}},{key:"path",value:function(t){st.setBroker(null,t)}},{key:"accessToken",value:function(t){st.setAccessToken(t)}},{key:"project",value:function(t){Z.setProject(t)}},{key:"action",value:function(e){t.Util.isArray(e)?(Z.setActionList(e),Z.hasContentAction()?Qe.initMonitors():Qe.resetMonitors()):t.CLog.error("[ConfigCommander.action] 引数の型が不正",e)}},{key:"extension",value:function(e){var n="[ConfigCommander.extension] ";t.Util.isObject(e)?t.Util.isString(e.name)&&!t.Util.isEmpty(e.name)?t.Util.isString(e.version)&&!t.Util.isEmpty(e.version)?(Z.setExtensionName(e.name),Z.setExtensionVersion(e.version)):t.CLog.error("".concat(n,"versionが不正な型か空の文字列"),e):t.CLog.error("".concat(n,"nameが不正な型か空の文字列"),e):t.CLog.error("".concat(n,"引数が不正な型"),e)}}],null&&yn(n.prototype,null),r&&yn(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(),dn=pn;function vn(t){return vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vn(t)}function mn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==vn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==vn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===vn(o)?o:String(o)),r)}var o}var bn=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"run",value:function(e){return!t.Util.isString(e)||t.Util.isEmpty(e)?(t.CLog.error("[DebugCommander.run] サブコマンドの型または値が不正",e,"type: ".concat(vn(e))),!1):t.Util.isFunction(this[e])?(this[e](),!0):(t.CLog.error("[DebugCommander.run] 未定義のサブコマンド",e),!1)}},{key:"start",value:function(){le=!0}},{key:"stop",value:function(){le=!1}}],null&&mn(n.prototype,null),r&&mn(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function gn(t){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gn(t)}function hn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==gn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==gn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===gn(o)?o:String(o)),r)}var o}var wn=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"buildContentData",value:function(e){if(!t.Util.isObject(e))return null;var n=document.createElement("li");n.setAttribute("data-ual-view-type",y.internal);var r=new ne(n);return r.setHitParameters(e),r}},{key:"run",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.buildContentData(e);st.hit(t,r,n)}}],null&&hn(n.prototype,null),r&&hn(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(),Sn=wn;function jn(t){return jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jn(t)}function kn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==jn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==jn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===jn(o)?o:String(o)),r)}var o}var Cn=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"run",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{flush:!1};return!t.Util.isString(e)||t.Util.isEmpty(e)?(t.CLog.error("[HitCommander.run] アクションIDの型または値が不正",e,"type: ".concat(jn(e))),!1):t.Util.isUndefined(n)||t.Util.isNull(n)||t.Util.isObject(n)?(t.Util.isObject(r)?t.Util.isBoolean(r.flush)||(r.flush=!1):r={flush:!1},Sn.run(e,n,r.flush),!0):(t.CLog.error("[HitCommander.run] ログパラメータの型または値が不正",n,"type: ".concat(t.Util.getType(n))),!1)}}],null&&kn(n.prototype,null),r&&kn(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(),_n=Cn;function On(t){return On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},On(t)}function Un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==On(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==On(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===On(o)?o:String(o)),r)}var o}var Pn=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,r=[{key:"run",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return!t.Util.isString(e)||t.Util.isEmpty(e)?(t.CLog.error("[UseCommander#run] サブコマンドの型または値が不正",e,"type: ".concat(On(e))),!1):t.Util.isFunction(this[e])?t.Util.isFunction(n)?(this[e](n),!0):(t.CLog.error("[UseCommander#run] コールバック関数の型が不正",n,"type: ".concat(On(n))),!1):(t.CLog.error("[UseCommander#run] 未定義のサブコマンド",e),!1)}},{key:"core",value:function(t){t(q())}}],null&&Un(n.prototype,null),r&&Un(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(),Tn={init:nn,offset:ln,ctrl:Ze,global:fn,config:dn,debug:bn,hit:_n,use:Pn};function En(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(0!==n.length){var o=n[0],i=n.slice(1);if(t.Util.findKey(Tn,o)&&t.Util.isFunction(Tn[o].run))try{Tn[o].run.apply(Tn[o],i)}catch(e){t.CLog.warning("[ual] 予期しないエラーが発生しました",e)}else t.CLog.warning("[ual] 指定されたコマンドが見つかりません",o)}else t.CLog.warning("[ual] コマンドが指定されていません")}for(var Ln in H)w(H,Ln)&&C.addRuleSet(Ln,H[Ln]);for(var xn in Ht)w(Ht,xn)&&(Ht[xn].validator=C,st.addBuilder(xn,Ht[xn]));t.CLog.prefix="[UAL]";var An=JSON.parse('{"name":"YASUserActionLogger-web","version":"3.1.0"}'),Nn=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.extension=An,function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var r in n)w(n,r)&&En("config",r,n[r]);var o=t.Util.isString(e)?e:"",i="".concat(o,"ualdebug"),u="".concat(o,"ualcmds");if(h(document)){var l=document.URL.match(new RegExp("".concat(i,"=(\\d)")));t.Util.isNull(l)||(t.CLog.logLevel=t.Util.normalizeToNumber(l[1]))}return g(window)&&t.Util.isArray(window[u])&&window[u].forEach((function(e){var n=Array.prototype.slice.call(e);t.CLog.debug("ual() was called from command queue.",e),En.apply(null,n)})),En}(e,n)}("tm",{project:"yas_useractionpool",action:["view_video_start","view_video_end","pageview","cv","search"]})}(),r.default}()}));