/*
 * Approach 2.1.0
 * Deeplink Library
 * @copyright 2022 Yahoo Japan Corporation
 */
!function(e){function r(t){if(n[t])return n[t].exports;var o=n[t]={exports:{},id:t,loaded:!1};return e[t].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var n={};return r.m=e,r.c=n,r.p="./dest",r(0)}([function(e,r,n){window.YAHOO=window.YAHOO||{},window.YAHOO.JP=window.YAHOO.JP||{},window.YAHOO.JP.Approach=function(e){var r={},t=n(1)(),o=n(3),i=function(){var r=n(5)();r.checkWebView().success(function(r){r.yjdnAppId=e.yjdnAppId||!1,r.yjdnEAppId=e.yjdnEAppId||!1,r.devMode=e.devMode||!1,r.testMode=e.testMode||!1,r.apiUrl=e.apiUrl||!1,a("webview",r)}).fail(function(r){var n={};n.device=o.getDevice(),n.yjdnAppId=e.yjdnAppId||!1,n.yjdnEAppId=e.yjdnEAppId||!1,n.devMode=e.devMode||!1,n.testMode=e.testMode||!1,n.apiUrl=e.apiUrl||!1,a("browser",n)})},a=function(e,r){if(t.getAllRequest){var o=t.getAllRequest(),i={browser:n(7),webview:n(12)}[e];t=i(r),c(o)}},c=function(e){for(var r=null;r=e.shift();)if(r.method)switch(r.method){case"replaceAppScheme":t.replaceAppScheme(r.url,r.option,r.apr).success(r.success).fallback(r.fallback).fail(r.fail)}};return r.openRedirect=function(){return t.openRedirect.apply(this,arguments)},r.replaceAppScheme=function(){return t.replaceAppScheme.apply(this,arguments)},setTimeout(i),r},window.YAHOO.JP.Approach.OPT_APP_OPEN=1,window.YAHOO.JP.Approach.OPT_STORE_OPEN=2,window.YAHOO.JP.Approach.ULT_EVENT="deeplink"},function(e,r,n){var t=function(){var e={},r=[],t=n(2);return e.openRedirect=function(r,n){return e.replaceAppScheme(window.location.href,r,n)},e.replaceAppScheme=function(e,n,o){var i=t();return setTimeout(function(){var t={};t.method="replaceAppScheme",t.url=e,t.option=n,t.apr=o||{},t.success=i.success,t.fallback=i.fallback,t.fail=i.fail,r.push(t)}),i.promise()},e.getAllRequest=function(){return r},e};e.exports=t},function(e,r){var n=function(){var e=function(){},r=function(){},n=function(){},t=function(){},o={};return o.promise=function(){return{success:function(r){return e=r,this},complete:function(e){return r=e,this},fallback:function(e){return n=e,this},fail:function(e){return t=e,this}}},o.success=function(){try{return"function"!=typeof e||e.apply(this,arguments)}catch(r){o.fail(r)}},o.complete=function(){return"function"!=typeof r||r.apply(this,arguments)},o.fallback=function(){try{return"function"!=typeof n||n.apply(this,arguments)}catch(e){o.fail(e)}},o.fail=function(){return"function"!=typeof t||t.apply(this,arguments)},o};e.exports=n},function(e,r,n){var t=function(){var e={},r={},t=function(){r=n(4)().detect(),r.majorOsVersion=0|r.osVersion.split(".")[0],r.majorBrowserVersion=0|r.browserVer.split(".")[0]};return e.isSupport=function(){return"unsupported"!==r.device},e.getOs=function(){return r.os},e.getBrowser=function(){return r.browser},e.getDevice=function(){return r.device},e.getOsVersion=function(){return r.osVersion},e.getMajorOsVersion=function(){return r.majorOsVersion},e.getBrowserVer=function(){return r.browserVer},e.getMajorBrowserVer=function(){return r.majorBrowserVersion},e.getDeviceInfo=function(){return r},t(),e};e.exports=t()},function(e,r){var n=function(){var e="ipad",r="iphone",n="android",t="chromium",o="ios",i="android",a="default",c="unsupported",s="unknown",u=3,p=4,f=5,l=7,d=8,m=9,v="^([a-zA-Z]*)/([.0-9]*) *\\(([^;]*)[; NUI]*; *([a-zA-Z ]*) *([_.0-9]*).*?\\) *[./a-zA-z0-9]* *(\\(.*\\))? *([a-zA-Z ]*)/([^ ]*) *([a-zA-Z ]*)?.*$",h={};h.detect=function(){var e=window.navigator.userAgent,r={device:c,browser:s,browserVer:s,os:s,osVersion:s},n=g(e);return n===!1?r:(r.device=w(n),r.browser=y(n),r.browserVer=n[d],r.os=b(r.device),r.osVersion=n[f].trim().replace(/_/g,"."),r)};var g=function(e){var r=e.match(v);return null!==r&&r},w=function(t){var o=t[u].trim(),i=t[p].trim();switch(!0){case/iPhone/i.test(o):case/iPod/i.test(o):return r;case/iPad/i.test(o):return e;case/Android/i.test(o)&&/Firefox/i.test(t[l]):t[f]=o.split(" ")[1]||s;case/Linux/.test(o)&&/Android/.test(i):return n;default:return c}},y=function(e){var r=e[l],n=e[m];switch(r){case"Firefox":case"Chrome":case"CriOS":case"SamsungBrowser":return r.toLowerCase();case"Version":return"Chrome"===n?t:a;default:return s}},b=function(t){switch(t){case r:case e:return o;case n:return i;default:return s}};return h};e.exports=n},function(e,r,n){var t=function(e){var r="https://approach.yahooapis.jp",t="https://stg-approach.yahooapis.jp",o="https://approach.yahooapis.jp",i="https://s.yimg.jp/images/approach/jslib/clear.gif",a="https://approach.yahoo.co.jp",c="https://stg-approach.yahoo.co.jp",s="https://approach.yahoo.co.jp",u="/rd/ul",p="https://auth.login.yahoo.co.jp",f="https://auth.login.yahoo.co.jp",l="https://auth.login.yahoo.co.jp",d="/deeplink/v1/token",m="/v1/map",v="/v1/deferred",h="mobiledeeplinkingcallback",g=3e3,w=500,y=n(2),b=n(6),k=e&&e.device||"unsupported",O={};O.getAppScheme=function(r,n,t,o){var i=y(),a=C()+m+"/"+k,c=b.addParams(a,{domain:r,path:n,tag:o,params:t,appid:e.yjdnAppId,eappid:e.yjdnEAppId,unitTest:e.testMode});return setTimeout(function(){I(c,i)}),i.promise()},O.setDeferred=function(r,n){var t=y(),o=C()+v,i=b.addParams(o,{appid:e.yjdnAppId,eappid:e.yjdnEAppId}),a={};a["X-YahooJ-B-Cookie"]=r;var c=JSON.stringify(n);return setTimeout(function(){A(i,a,c,!1,t)}),t.promise()},O.getYConnectToken=function(r,n){var t=y(),o=P()+d,i={aud:r,azp:e.yjdnAppId,eazp:e.yjdnEAppId,snonce:n},a=S(i);return setTimeout(function(){A(o,null,a,!0,t)}),t.promise()},O.getUniversalLinksRedirectorUrl=function(e){var r=x()+u;return b.addParams(r,e)},O.checkWebView=function(){var e=b.addParams(i,{method:"init"});return U(e)},O.schemeCanOpen=function(e,r){var n=b.addParams(i,{method:"canopen",deeplinkurl:e,deeplinkinfo:JSON.stringify(r)});return U(n)},O.schemeOpen=function(e,r){var n=b.addParams(i,{method:"open",deeplinkurl:e,sig:r});return U(n)},O.storeOpen=function(e,r,n){var t=b.addParams(i,{method:"openstoredeferred",deeplinkurl:e,storeurl:r,app_identifier:n});return U(t)};var U=function(e){var r=y(),n=!1,t=h+new Date/1;window[t]=function(e){n=!0,r.success(e),delete window[t]};var o=document.createElement("iframe");o.src=b.addParams(e,{callback:t}),o.style.display="none";var i=function(){n||(r.fail(!1),delete window[t]),setTimeout(function(){o.parentNode.removeChild(o),r.complete()})};return setTimeout(function(){document.body.appendChild(o)}),setTimeout(i,w),r.promise()},I=function(e,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.timeout=g,n.ontimeout=function(){r.fail(new Error("Request Timeout"))},n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status||304===n.status)r.success(JSON.parse(n.responseText));else{var e=new Error("Unexpect Response. status=["+n.status+"]");r.fail(e)}},n.send()},A=function(e,r,n,t,o){var i=new XMLHttpRequest;if(i.open("POST",e,!0),t)i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.withCredentials=!0;else if(i.setRequestHeader("Content-Type","application/json"),r)for(var a in r)r.hasOwnProperty(a)&&i.setRequestHeader(a,r[a]);i.timeout=g,i.ontimeout=function(){o.fail(new Error("Request Timeout"))},i.onreadystatechange=function(){if(4===i.readyState){if(200===i.status||204===i.status)o.success(JSON.parse(i.responseText));else{var e=new Error("Unexpect Response. status=["+i.status+"]");o.fail(e)}o.complete()}},i.send(n)},C=function(){try{switch(!0){case e.devMode:return o;case e.testMode:return t;default:return r}}catch(n){return r}},x=function(){try{switch(!0){case e.devMode:return s;case e.testMode:return c;default:return a}}catch(r){return a}},P=function(){try{switch(!0){case e.devMode:return l;case e.testMode:return f;default:return p}}catch(r){return p}},S=function(e){var r=[];for(var n in e)if(e[n]){var t=encodeURIComponent(n)+"="+encodeURIComponent(e[n]);r.push(t)}return r.join("&").replace(/%20/g,"+")};return O};e.exports=t},function(e,r){var n=function(){var e={};e.parseUrl=function(e){var r=document.createElement("a");return r.href=e,r},e.addParams=function(r,n){if("object"!=typeof n)return r;var t=e.parseUrl(r),o=[];if(t.search)for(var i=t.search.substring(1).split("&"),a=0;a<i.length;a++){var c=i[a].split("=");c[0]in n&&n[c[0]]||o.push(i[a])}for(var s in n)n.hasOwnProperty(s)&&n[s]&&o.push(s+"="+encodeURIComponent(n[s]));if(0===o.length)return r;var u=t.href.split("?")[0];return u+"?"+o.join("&")},e.parseQuery=function(e){/^\?/.test(e)&&(e=e.substr(1));for(var r={},n=e.split("&"),t=0;t<n.length;t++)if(n[t]){var o=n[t].split("=");r[o[0]]=decodeURIComponent(o[1])}return r},e.concatQuery=function(e){var r=[];for(var n in e)e.hasOwnProperty(n)&&r.push(n+"="+encodeURIComponent(e[n]));return r.join("&")},e.redirect=function(e){window.location.href!==e&&(window.location=e)},e.getBCookie=function(){for(var e=document.cookie.split(";"),r=0;r<e.length;r++){var n=e[r].replace(/^ *| *$/,"");if(/^B=/.test(n))return n}return""};for(var r=[],n=0;n<256;n++)r[n]=(n+256).toString(16).substr(1);return e.generateUUID=function(){var e=window.crypto;if(e&&e.getRandomValues){var n=new Uint8Array(16);e.getRandomValues(n),n[6]=15&n[6]|64,n[8]=63&n[8]|128;var t=r;return t[n[0]]+t[n[1]]+t[n[2]]+t[n[3]]+"-"+t[n[4]]+t[n[5]]+"-"+t[n[6]]+t[n[7]]+"-"+t[n[8]]+t[n[9]]+"-"+t[n[10]]+t[n[11]]+t[n[12]]+t[n[13]]+t[n[14]]+t[n[15]]}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=16*Math.random()|0,n="x"===e?r:3&r|8;return n.toString(16)})},e.clone=function(r){if("object"!=typeof r)return r;if(r instanceof Array)return r.concat();if(r instanceof Date)return new Date(r.getTime());if(r instanceof Object){var n={};return Object.keys(r).forEach(function(t){n[t]=e.clone(r[t])}),n}},e.objectAssign=function(r,n){if("object"==typeof r){if("object"!=typeof n)return r;var t=e.clone(r);for(var o in n)n.hasOwnProperty(o)&&(t[o]||(t[o]=n[o]));return t}},e.objectTrim=function(r,n){var t=e.clone(r),o=function(e){return!n||n.indexOf(e)!==-1};for(var i in t)t.hasOwnProperty(i)&&!t[i]&&o(i)&&delete t[i];return t},e};e.exports=n()},function(e,r,n){var t=function(e){var r="0",t=3,o=1,i=2,a=n(8)(e),c=n(2),s=n(6),u={};u.openRedirect=function(e,r){var n=window.location.href;return u.replaceAppScheme(n,e,r)},u.replaceAppScheme=function(e,n,o){var i=c();if(!n)throw new Error("Option is null.");if((n>>>=0)>t)throw new Error("Unknown option.");o=o||{};var u=a.getDeviceConfig(o);if(a.useRedirector(o)){var d=a.createRedirectorUrl(e,n,o,r);return s.redirect(d),i.promise()}return a.getSchemeData(e,o.tag).success(function(t){var c=s.generateUUID();if(a.sendDeepLinkLog(n,c,t,o,r),t.option=n,t.config=s.clone(o),n===YAHOO.JP.Approach.OPT_STORE_OPEN){var l=u.storeUrl||o.storeUrl||t.store_url;return f(l,c,t,i)}var d=s.addParams(t.deeplink,o.params);return d=a.addMdl(d,c,e,o.doneUrl),t.config.isLoggedIn!==!0?p(d,t,i):void a.getYConnectInfo(t).success(function(e){t.yconnectInfo=e}).complete(function(){p(d,t,i)})}).fail(function(r){var n=u.webUrl||o.webUrl||e;return l(n,r,i)}),i.promise()};var p=function(e,n,t){var i=a.getDirectionInfo(e,n),c=a.getLogInfo(n.option,r,o,n.identifier);if(t.success(i,c)===!1)return t.complete();var u=!!(n.option&YAHOO.JP.Approach.OPT_STORE_OPEN);n.fallbackTo=u?"store":"web",u?a.setDeferred(e,n).complete(function(){e=s.addParams(e,n.yconnectInfo),a.deeplink(e,n,r,t)}):(e=s.addParams(e,n.yconnectInfo),a.deeplink(e,n,r,t))},f=function(e,n,t,o){var c=a.getDirectionInfo(e,t),u=a.getLogInfo(t.option,r,i,t.identifier);if(o.success(c,u)===!1)return o.complete();var p=s.addParams(t.deeplink,t.config.params);p=a.addMdl(p,n,t.src,t.config.doneUrl),a.setDeferred(p,t).complete(function(){a.openStore(e,t.identifier,t.config),o.complete()})},l=function(e,r,n){return n.fail(r)!==!1&&s.redirect(e),n.complete()};return u};e.exports=t},function(e,r,n){var t=function(e){var r="1",t="0",o=2,i=3,a={},c=n(3).getDeviceInfo(),s=n(6),u=n(5)(e),p=n(9),f=n(2),l=function(){switch(c.os){case"ios":return n(10).call(a,c);case"android":return n(11).call(a,c);default:return{deeplink:function(){},openStore:function(){}}}}();a.getSchemeData=function(e,r){var n=f(),t=s.parseUrl(e),o=t.host,i=t.pathname,a=t.search.substr(1);return u.getAppScheme(o,i,a,r).success(function(r){var t=r.results;if(0===t.length)return n.fail(new Error("Does not match any scheme data."));var o=t.shift();return o.src=e,o.extra=t?t:[],n.success(o)}).fail(function(e){return n.fail(e||new Error("Could not get Map Data"))}),n.promise()},a.setDeferred=function(n,o){var i=o.config||{},a=s.getBCookie(),c={deeplink:n,appid:e.yjdnAppId,eappid:e.yjdnEAppId,app_identifier:o.identifier,clientid:o.client_id,login:i.isLoggedIn?r:t};return u.setDeferred(a,s.objectTrim(c))},a.getYConnectInfo=function(e){var r=s.generateUUID(),n=e.client_id,t=f();return u.getYConnectToken(n,r).success(function(e){if(!e.hasOwnProperty("token"))throw new Error("Could not get YConnect Token");var n={};return n.snonce=r,n.dltoken=e.token,t.success(n),t.complete()}).fail(function(e){return t.fail(e||new Error("Could not get YConnect Info")),t.complete()}),t.promise()},a.addMdl=function(e,r,n,t,o,i){var a={};a.referer=window.location.href,a.src=n,a.history=0,a.dlid=r,"string"==typeof t&&(a.done=t),"string"==typeof o&&(a.short_name=o),"string"==typeof i&&(a.identifier=i);var c={mdl:JSON.stringify(a)};return s.addParams(e,c)},a.getDirectionInfo=function(e,r){var n={};return n.direction=e,n.src=r.src,n.deeplink=r.deeplink,n.name=r.name,n.icon_url=r.icon_url,n.store_url=r.store_url,n.identifier=r.identifier,n.extra=r.extra||[],n},a.getLogInfo=function(e,r,n,t){return{ap_opt:e.toString(10),ap_wv:r,ap_to:n,ap_id:t,ap_hist:"0"}},a.schemeCanOpen=u.schemeCanOpen,a.schemeOpen=u.schemeOpen,a.storeOpen=function(e,r,n){var t=n.config[c.os]||{};return t.installReferrer&&(r=s.addParams(r,{referrer:t.installReferrer})),u.storeOpen(e,r,n.identifier)},a.useRedirector=function(e){switch(!0){case d(e[c.os]):return!0;default:return!1}},a.createRedirectorUrl=function(e,r,n,t){switch(!0){case d(n[c.os]):var o=m(e,r,n,t);return u.getUniversalLinksRedirectorUrl(o);default:throw new Error("this is not redirect pattern.")}};var d=function(e){e=e||{};var r=e.universalLinks&&e.universalLinks.enable;return"ios"===c.os&&c.majorOsVersion>=9&&r!==!1},m=function(r,n,t,o){var i,a=t.ios||{},u=a.universalLinks||{},p="undefined"!=typeof DSCustomLogger&&DSCustomLogger.customLoggerCoreConf&&DSCustomLogger.customLoggerCoreConf.keys||{};i=n&YAHOO.JP.Approach.OPT_STORE_OPEN?a.storeUrl||t.storeUrl||null:a.webUrl||t.webUrl||null;var f={srcurl:r,opt:n,device:c.device,fallback:i,ignore_fcap:u.ignoreFallbackCap,tag:t.tag,params:JSON.stringify(t.params||{}),done:t.doneUrl,referer:window.location.href,service:p.service,wv:o,identifier:window.location.hostname,login:t.isLoggedIn?"1":"0",code:t.code,custom_log:JSON.stringify(t.customLog||{}),appid:t.isLoggedIn?e.yjdnAppId:null,eappid:t.isLoggedIn?e.yjdnEAppId:null};return s.objectTrim(f)};return a.sendDeepLinkLog=function(r,n,t,o,i){var a=p(),c={ap_type:0,ap_ver:2,ap_opt:r,ap_wv:i,ap_id:e.identifier||window.location.hostname,ap_to:t.identifier,ap_login:o.isLoggedIn?1:0,ap_dlid:n,ap_map:t.map_id,ap_code:o.code||""};c=s.objectAssign(c,o.customLog),a.send(c)},a.getDeviceConfig=function(r){var n={};switch(e.device){case"iphone":n=r.ios||{};break;case"ipad":n=r.ios||{};break;case"android":n=r.android||{}}return n},a.deeplink=function(e,r,n,t){var s,u,p=r.config,f=p[c.os]||{};switch(r.fallbackTo){case"store":u=f.storeUrl||p.storeUrl||r.store_url,s=o;break;case"web":u=f.webUrl||p.webUrl||r.src,s=i}var d=a.getDirectionInfo(u,r),m=a.getLogInfo(r.option,n,s,r.identifier);r.fallbackUrl=u,r.fallbackInfo={directionInfo:d,logInfo:m},l.deeplink(e,r,t)},a.openStore=function(e,r,n){var t=s.clone(n[c.os])||{};t.identifier=r,e=n.storeUrl||t.storeUrl||e,l.openStore(e,t)},a};e.exports=t},function(e,r){var n=function(){var e="deeplink",r="2080370568",n={},t="undefined"!=typeof DSCustomLogger&&DSCustomLogger.CustomLogger||!1,o="undefined"!=typeof DSCustomLogger&&DSCustomLogger.customLoggerCoreConf&&DSCustomLogger.customLoggerCoreConf.keys||{};return n.send=function(n){if(t===!1)return void console.warn("Logger object was not included.");var i=new t({log_view_on_init:!1,hierarchyid:r}),a=i.setService(o.service||"").setServiceid(o.srvid||"").initCustomLoggerCore();a.logEvent(e,n)},n};e.exports=n},function(e,r,n){var t=function(e){var r={},t=n(6);r.deeplink=function(r,n,t){switch(!0){case 9===e.majorOsVersion:return a(r,n,t);case e.majorOsVersion<=7:case"default"!==e.browser:return o(r,n,t);case 8===e.majorOsVersion:return i(r,n,t);default:return a(r,n,t)}};var o=function(e,r,n){var o=document.createElement("iframe");o.style.display="none",o.src=e;var i=new Date;setTimeout(function(){var e=new Date-i;if(e<750){var a=r.fallbackInfo||{};n.fallback(a.directionInfo,a.logInfo)!==!1&&t.redirect(r.fallbackUrl)}o.parentNode.removeChild(o),n.complete()},700),document.body.appendChild(o)},i=function(e,r,n){var o=!1,i=r.config.ios||{},a=i.safariFallbackTime||2500;window.onblur=function(){o=!0,window.onblur=null};var c=document.createElement("iframe");c.style.display="none",c.src=e,document.body.appendChild(c),setTimeout(function(){if(o===!1){var e=r.fallbackInfo||{};n.fallback(e.directionInfo,e.logInfo)!==!1&&t.redirect(r.fallbackUrl)}return c.parentNode.removeChild(c),n.complete()},a)},a=function(e,r,n){t.redirect(e),n.complete()};return r.openStore=function(e){return t.redirect(e)},r};e.exports=t},function(e,r,n){var t=function(e){var r="intent://%s#Intent;scheme=%s;package=%s;S.browser_fallback_url=%s;end",t="intent://details?id=%s&url=%s&referrer=%s#Intent;scheme=market;action=android.intent.action.VIEW;package=com.android.vending;end;",o="market://details?id=%s",i="play.google.com",a="https://play.google.com/store/apps/details",c=1,s=2,u=3,p={},f=n(6);p.deeplink=function(r,n,t){switch(e.browser){case"chrome":case"chromium":case"samsungbrowser":return l(r,n,t);default:return d(r,n,t)}};var l=function(e,r,n){var t=m(e,r);return f.redirect(t),n.complete()},d=function(e,r,n){var t=document.createElement("iframe");t.style.display="none",document.body.appendChild(t),t.src=e,t.onload=function(){var e=r.fallbackInfo||{};if(n.fallback(e.directionInfo,e.logInfo)!==!1)switch(r.fallbackTo){case"store":p.openStore(r.fallbackUrl,r);break;case"web":f.redirect(r.fallbackUrl)}return t.parentNode.removeChild(t),n.complete()}},m=function(e,r){var n=r.config.android||{},t={store:v,web:h}[r.fallbackTo](e,r,n);return t},v=function(e,n,o){var i=f.parseUrl(e),u=i.hostname,p=i.pathname.replace(/^\/*/,""),l=i.search.replace(/^\?/,""),d=f.parseUrl(n.fallbackUrl),m=f.parseQuery(d.search),v=o.installReferrer||m.referrer,h=w(n.fallbackUrl,n.identifier);switch(h){case c:n.fallbackTo="web";break;case s:n.fallbackTo="web";var y=f.addParams(a,m);n.fallbackUrl=g(y,v)}var b={store:{format:t,replaceData:[n.identifier,encodeURIComponent(e),v]},web:{format:r,replaceData:[(u?u+"/":"")+p+"?"+l,i.protocol.slice(0,-1),n.identifier,encodeURIComponent(n.fallbackUrl)]}}[n.fallbackTo],k=0;return b.format.replace(/%s/g,function(){return b.replaceData[k++]})},h=function(e,n,t){var o=f.parseUrl(e),i=o.hostname,a=o.pathname.replace(/^\/*/,""),c=o.search.replace(/^\?/,""),s=[(i?i+"/":"")+a+"?"+c,o.protocol.slice(0,-1),n.identifier,encodeURIComponent(n.fallbackUrl)],u=0;return r.replace(/%s/g,function(){return s[u++]})};p.openStore=function(e,r){var n=w(e);switch(n){case c:return f.redirect(e);default:var t=f.parseUrl(e),i=f.parseQuery(t.search),a=i.id?i.id:r.identifier,s=r.installReferrer||i.referrer;return e=o.replace(/%s/,a),e=g(e,s),f.redirect(e)}};var g=function(e,r){if(!r)return e;var n=f.parseUrl(e).search,t=f.parseQuery(n);return t.referrer=r,e.split("?")[0]+"?"+f.concatQuery(t)},w=function(e,r){var n=f.parseUrl(e),t=f.parseQuery(n.search);return/^https?/.test(n.protocol)&&n.hostname!==i?c:t.id===r?u:s};return p};e.exports=t},function(e,r,n){var t=function(e){var r="1",t=3,o=1,i=2,a=3,c=n(8)(e),s=n(2),u=n(6),p={};p.openRedirect=function(e,r){var n=window.location.href;return p.replaceAppScheme(n,e,r)},p.replaceAppScheme=function(n,o,i){var a=s();if(!o)throw new Error("Option is null.");if((o>>>=0)>t)throw new Error("Unknown option.");i=i||{};var p=c.getDeviceConfig(i);return c.getSchemeData(n,i.tag).success(function(t){var s=u.generateUUID();if(c.sendDeepLinkLog(o,s,t,i,r),t.option=o,t.config=u.clone(i),o===YAHOO.JP.Approach.OPT_STORE_OPEN){var m=p.storeUrl||i.storeUrl||t.store_url;return l(m,s,t,a)}var v=u.addParams(t.deeplink,i.params);c.schemeCanOpen(v,t).success(function(r){if(r.interrupt)return a.complete();if(!r.open)throw new Error("Target App does not exist.");var o=r.done?r.done:i.doneUrl?i.doneUrl:e.launch;return v=c.addMdl(v,s,n,o,r.short_name,r.identifier),t.config.isLoggedIn!==!0?f(v,r.sig,t,a):void c.getYConnectInfo(t).success(function(e){v=u.addParams(v,e)}).complete(function(){f(v,r.sig,t,a)})}).fail(function(e){if(o&YAHOO.JP.Approach.OPT_STORE_OPEN){var r=p.storeUrl||i.storeUrl||t.store_url;return l(r,s,t,a).fail(function(e){u.redirect(r)})}var n=p.webUrl||i.webUrl||t.src;d(n,e,a,t)})}).fail(function(e){var r=p.webUrl||i.webUrl||n;return d(r,e,a)}),a.promise()};var f=function(e,n,t,i){var a=c.getDirectionInfo(e,t),s=c.getLogInfo(t.option,r,o,t.identifier);return i.success(a,s)!==!1?c.schemeOpen(e,n).complete(i.complete):i.complete()},l=function(n,t,o,a){var s=c.getDirectionInfo(n,o),p=c.getLogInfo(o.option,r,i,o.identifier);if(a.success(s,p)!==!1){var f=u.addParams(o.deeplink,o.config.params);return f=c.addMdl(f,t,o.src,o.config.doneUrl||e.launch),c.storeOpen(f,n,o).complete(a.complete)}return a.complete()},d=function(e,n,t,o){var i,s=[];if(o){var p=c.getDirectionInfo(e,o),f=c.getLogInfo(o.option,r,a,o.identifier);s.push(p),s.push(f),i=t.success}else s.push(n),i=t.fail;return i.apply(null,s)!==!1&&u.redirect(e),t.complete()};return p};e.exports=t}]);